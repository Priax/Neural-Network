<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neural Network: Documentation MLP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Neural Network
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Documentation MLP</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Introduction</h1>
<p>Ce projet vise à concevoir un perceptron multicouche (MLP) pour modéliser les états de jeu d'échecs, avec comme objectif d'effectuer des prédictions précises sur des positions spécifiques du plateau. En utilisant des techniques comme la propagation avant, la rétropropagation et l'initialisation He, ce modèle apprend à partir des données pour optimiser ses prédictions. Ce document décrit en détail les composants, les algorithmes et les justifications des choix effectués dans l'implémentation.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
1. Fonctions d'activation</h1>
<div class="fragment"><div class="line">(x)</div>
</div><!-- fragment --><p> : Renvoie le maximum entre 0 et x (fonction ReLU).</p>
<div class="fragment"><div class="line">_derivative(x)</div>
</div><!-- fragment --><p> : Renvoie la dérivée de la fonction ReLU.</p>
<div class="fragment"><div class="line">(x)</div>
</div><!-- fragment --><p> : Applique la fonction sigmoïde sur x.</p>
<div class="fragment"><div class="line">_derivative(x)</div>
</div><!-- fragment --><p> : Renvoie la dérivée de la fonction sigmoïde.</p>
<div class="fragment"><div class="line">(x)</div>
</div><!-- fragment --><p> : Applique la fonction tangente hyperbolique.</p>
<div class="fragment"><div class="line">_derivative(x)</div>
</div><!-- fragment --><p> : Renvoie la dérivée de la fonction tangente hyperbolique.</p>
<div class="fragment"><div class="line">(x)</div>
</div><!-- fragment --><p> : Applique la fonction softmax pour convertir les logits en probabilités.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
2. Fonctions de perte</h1>
<div class="fragment"><div class="line">_cross_entropy(y_true, y_pred)</div>
</div><!-- fragment --><p> : Calcule l'entropie croisée pour la classification multi-classe.</p>
<div class="fragment"><div class="line">_cross_entropy_derivative(y_true, y_pred)</div>
</div><!-- fragment --><p> : Calcule la dérivée de l'entropie croisée.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
3. Classe GeneralizedMLP</h1>
<p>Classe implémentant un Multi Layered Perceptron (MLP) personnalisable.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Méthodes principales</h2>
<div class="fragment"><div class="line">__init__(layer_sizes, activations, loss)</div>
</div><!-- fragment --><p> :</p>
<p>Initialise le MLP avec les tailles des couches, les fonctions d'activation, et la fonction de perte.</p>
<p>Vérifie la correspondance entre le nombre de couches et les fonctions d'activation.</p>
<p>Initialise les poids et les biais.</p>
<div class="fragment"><div class="line">_initialize_weights()</div>
</div><!-- fragment --><p> :</p>
<p>Initialise les poids avec l'initialisation He.</p>
<p>Initialise les biais à 0.</p>
<div class="fragment"><div class="line">_get_activation(name)</div>
</div><!-- fragment --><p> :</p>
<p>Retourne la fonction d'activation et sa dérivée correspondant au nom fourni.</p>
<div class="fragment"><div class="line">(x)</div>
</div><!-- fragment --><p> :</p>
<p>Effectue une propagation avant sur les données d'entrée X, en calculant les sorties de chaque couche du réseau à partir des poids, des biais et des fonctions d'activation spécifiés. Cela permet de prédire les résultats en fonction des données d'entrée actuelles.</p>
<div class="fragment"><div class="line">(X, y, learning_rate)</div>
</div><!-- fragment --><p> :</p>
<p>Calcule les gradients des poids et biais via rétropropagation.</p>
<p>Met à jour les poids et biais avec le taux d'apprentissage.</p>
<div class="fragment"><div class="line">(X, y, epochs, learning_rate, batch_size)</div>
</div><!-- fragment --><p> :</p>
<p>Entraîne le modèle sur les données d'entrée et de sortie X et y.</p>
<p>Affiche la perte et la précision tous les 10 epochs.</p>
<div class="fragment"><div class="line">(filename)</div>
</div><!-- fragment --><p> :</p>
<p>Sauvegarde les poids, les biais, et la configuration dans un fichier pickle.</p>
<div class="fragment"><div class="line">(filename)</div>
</div><!-- fragment --><p> :</p>
<p>Charge les poids, les biais, et la configuration à partir d'un fichier pickle.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
1. Gestion des états du jeu d'échecs</h1>
<div class="fragment"><div class="line">_state_labels</div>
</div><!-- fragment --><p> : Dictionnaire associant les états du jeu d'échecs (Check Black, Stalemate, Nothing...) à des indices numériques.</p>
<div class="fragment"><div class="line">_custom_fen(fen)</div>
</div><!-- fragment --><p> :</p>
<p>Valide et extrait les informations d'un FEN (Forsyth-Edwards Notation).</p>
<p>Retourne un dictionnaire contenant les placements des pièces, les droits de roque, le nombre de coups, etc.</p>
<div class="fragment"><div class="line">_fens_from_directory(directory)</div>
</div><!-- fragment --><p> :</p>
<p>Parcourt un répertoire et extrait tous les FEN valides à partir des fichiers texte.</p>
<div class="fragment"><div class="line">_chessboard(fen)</div>
</div><!-- fragment --><p> :</p>
<p>Encode le plateau d'échecs représenté par un FEN en une matrice 1D utilisable pour le modèle.</p>
<p>Chaque case est représentée par un vecteur de 12 dimensions correspondant à toutes les pièces possibles.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
1. Exemple d'utilisation</h1>
<p>Taille d'entrée : 64 * 12 (plateau d'échecs encodé).</p>
<p>Couches cachées : [256, 128, 64]. <br  />
 Ces tailles ont été choisies pour équilibrer la capacité d'apprentissage et les besoins en calcul. Une couche initiale de 256 neurones permet d'extraire des motifs complexes des données brutes encodées. Les couches successives de 128 et 64 neurones réduisent progressivement la dimensionnalité, favorisant une meilleure généralisation et limitant le surapprentissage (overfitting). Cette architecture a montré une bonne performance pour capturer les relations non linéaires dans les états de jeu d'échecs.</p>
<p>Taille de sortie : 6 (correspondant à game_state_labels).</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Entraînement :</h2>
<div class="fragment"><div class="line">mlp = GeneralizedMLP(</div>
<div class="line">    layer_sizes=[64 * 12, 256, 128, 64, 6],</div>
<div class="line">    activations=[<span class="stringliteral">&#39;relu&#39;</span>, <span class="stringliteral">&#39;relu&#39;</span>, <span class="stringliteral">&#39;relu&#39;</span>, <span class="stringliteral">&#39;softmax&#39;</span>]</div>
<div class="line">)</div>
<div class="line">mlp.train(X_train, y_train, epochs=100, learning_rate=0.01, batch_size=32)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
6. Notes</h1>
<p>Robustesse : Les fonctions de validation des FEN garantissent des entrées valides.</p>
<p>Modularité : Le modèle est hautement configurable (activation, taille des couches, perte).</p>
<h1><a class="anchor" id="autotoc_md10"></a>
Améliorations possibles :</h1>
<ul>
<li>Ajout de mécanismes de régularisation (dropout, L2).</li>
<li>Support d'autres fonctions de perte.</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Note</h1>
<p>Du Multithreading n'a pas été rajouté car il a été testé que le modèle fonctionnait mieux en mélangeant plusieurs données différentes (pour que le modèle ne s'adapte pas trop à un seul état).</p>
<p>Le modèle fonctionne donc mieux en récupérant plusieurs données différentes, qui seront ensuites shuffle entre elles, puis le modèle s'entraînera. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
